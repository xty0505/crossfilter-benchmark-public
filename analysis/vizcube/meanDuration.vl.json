{
  "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
  "description": "A simple bar chart with embedded data.",
  "data": {
    "values": [
      {
        "dataset_size": "1M",
        "dataset": "flights(1M)",
        "driver": "direct",
        "meanDuration": 921.739184953,
        "countAnswered": 1595,
        "durationCiLower": 902.5780417239,
        "durationCiUpper": 940.900328182,
        "durationStd": 390.1429631326,
        "countViolated": 1109,
        "responseRate": 0.3047021944
      },
      {
        "dataset_size": "1M",
        "dataset": "flights(1M)",
        "driver": "backward",
        "meanDuration": 508.94169279,
        "countAnswered": 1595,
        "durationCiLower": 496.0126529869,
        "durationCiUpper": 521.870732593,
        "durationStd": 263.2501536536,
        "countViolated": 198,
        "responseRate": 0.875862069
      },
      {
        "dataset_size": "10M",
        "dataset": "bike(10M)",
        "driver": "direct",
        "meanDuration": 47.498,
        "countAnswered": 1500,
        "durationCiLower": 42.1628624858,
        "durationCiUpper": 52.8331375142,
        "durationStd": 105.3397660282,
        "countViolated": false,
        "responseRate": 1.0
      },
      {
        "dataset_size": "10M",
        "dataset": "bike(10M)",
        "driver": "backward",
        "meanDuration": 1.428,
        "countAnswered": 1500,
        "durationCiLower": 1.3947717317,
        "durationCiUpper": 1.4612282683,
        "durationStd": 0.6560764368,
        "countViolated": false,
        "responseRate": 1.0
      }
    ]
  },
  "transform": [
    {"calculate": "round(datum.meanDuration) + 'ms'", "as": "durationNice"},
    {"calculate": "clamp(datum.meanDuration,0,407)", "as": "durationTextPos"}
  ],
  "facet": {
    "row": {
      "field": "dataset",
      "type": "ordinal",
      "title": "Dataset",
      "header": {"labelPadding": 2, "titlePadding": 0}
    }
  },
  "config": {"facet": {"spacing": 5}},
  "spec": {
    "height": 120,
    "width": 170,
    "layer": [
      {
        "mark": {"type": "rule", "color": "red"},
        "encoding": {"x": {"value": 105}}
      },
      {
        "mark": {"type": "bar", "clip": true, "height": 22},
        "encoding": {
          "y": {"field": "driver", "type": "nominal", "title": "Query method"},
          "x": {
            "field": "meanDuration",
            "type": "quantitative",
            "scale": {"domain": [0, 1500]},
            "title": "Mean Duration (with Std. Dev.)"
          },
          "color": {
            "field": "driver",
            "type": "nominal",
            "title": "Query method",
            "legend": null
          }
        }
      },
      {
        "mark": {"type": "errorbar", "clip": true},
        "encoding": {
          "x": {
            "field": "meanDuration",
            "type": "quantitative",
            "scale": {"domain": [0, 600]},
            "title": null
          },
          "xError": {"field": "durationStd"},
          "y": {"field": "driver", "type": "nominal", "title": "Query method"}
        }
      },
      {
        "mark": {
          "type": "text",
          "align": "left",
          "baseline": "middle",
          "clip": true,
          "dy": -5,
          "dx": 2
        },
        "encoding": {
          "text": {"field": "durationNice", "type": "nominal"},
          "y": {"field": "driver", "type": "nominal", "title": "Query method"},
          "x": {"field": "durationTextPos", "type": "quantitative"}
        }
      }
    ]
  }
}